<!-- 2017/8/28 -->

# 单线程模型

## 一、js单线程

JS只在一个线程上运行。即JS同时只能执行一个任务，其他任务须排队等待。

JS引擎有多个线程，单个脚本只在一个线程上运行，其他线程在后台配合。

## 二、消息队列

JS引擎除了一个运行线程，还提供一个消息队列。新消息进入队列时，会自动排在队列尾端。

每条消息与一个回调函数相联系。如果消息没有回调函数，则消息被遗弃。

特殊情况：`setTimeout`在指定时间向消息队列添加消息，这条消息须等到其他消息处理完，才会得到处理。

若当前执行栈空了，消息队列会取出第一位消息，传入程序。程序开始执行对应回调函数，等执行完，再处理下条消息。

## 三、事件循环

一轮又一轮地处理消息队列的消息，执行对应的回调函数。

1、同步任务：在JS执行进程上排队执行的任务，前个任务执行完毕，才执行后一个任务

2、异步任务：不进入JS执行进程、而进入"任务队列"的任务。只有"任务队列"通知主进程可执行某个异步任务，该任务才会进入JS进程执行。

## 参考文档

- [单线程模型](http://javascript.ruanyifeng.com/advanced/single-thread.html)